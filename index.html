<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Auth Firebase - Simple</title>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import {
  getAuth,
  createUserWithEmailAndPassword,
  signInWithEmailAndPassword,
  sendEmailVerification,
  signOut,
  onAuthStateChanged
} from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";

/* üîë CONFIG FIREBASE */
const firebaseConfig = {
    apiKey: "AIzaSyAQkCNtVCzXyIFLNlj9iKQvaMcg197zpKY",
    authDomain: "tttt-57bdb.firebaseapp.com",
    projectId: "tttt-57bdb",
    storageBucket: "tttt-57bdb.firebasestorage.app",
    messagingSenderId: "136572123296",
    appId: "1:136572123296:web:886d093854c6827f10b1c5",
    measurementId: "G-3E8ZVGPDTX"
  };

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

/* üëÄ Gestion affichage */
const show = (id) => {
  ["signup","login","dashboard"].forEach(s =>
    document.getElementById(s).style.display = "none"
  );
  document.getElementById(id).style.display = "block";
};

/* üîÑ √âtat utilisateur */
onAuthStateChanged(auth, user => {
  if (user && user.emailVerified) {
    show("dashboard");
  } else {
    show("login");
  }
});

/* üìù INSCRIPTION */
window.signup = async () => {
  try {
    const email = sEmail.value;
    const pass = sPass.value;

    const userCred =
      await createUserWithEmailAndPassword(auth, email, pass);

    await sendEmailVerification(userCred.user);
    alert("V√©rifie ton email !");
    show("login");
  } catch (e) {
    alert(e.message);
  }
};

/* üîê CONNEXION */
window.login = async () => {
  try {
    const userCred =
      await signInWithEmailAndPassword(auth, lEmail.value, lPass.value);

    if (!userCred.user.emailVerified) {
      alert("Email non v√©rifi√© !");
      await signOut(auth);
    }
  } catch (e) {
    alert(e.message);
  }
};

/* üö™ D√âCONNEXION */
window.logout = () => signOut(auth);
</script>

<style>
body { font-family: Arial; background:#f0f0f0; text-align:center; padding-top:50px; }
.box { background:white; width:300px; margin:auto; padding:20px; border-radius:8px; }
input, button { width:100%; margin:6px 0; padding:8px; }
button { background:#007bff; color:white; border:none; cursor:pointer; }
</style>
</head>

<body>

<div id="signup" class="box" style="display:none">
  <h2>Cr√©er un compte</h2>
  <input id="sEmail" type="email" placeholder="Email">
  <input id="sPass" type="password" placeholder="Mot de passe">
  <button onclick="signup()">S'inscrire</button>
</div>

<div id="login" class="box">
  <h2>Connexion</h2>
  <input id="lEmail" type="email" placeholder="Email">
  <input id="lPass" type="password" placeholder="Mot de passe">
  <button onclick="login()">Se connecter</button>
  <p><a href="#" onclick="show('signup')">Cr√©er un compte</a></p>
</div>

<div id="dashboard" class="box" style="display:none">
  <h2>Bienvenue üéâ</h2>
  <p>Acc√®s s√©curis√©</p>
  <button onclick="logout()">Se d√©connecter</button>
</div>

</body>
</html>