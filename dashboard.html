<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Dashboard</title>
<style>
body{font-family:Arial;background:#eee;padding:20px}
.box{background:#fff;padding:20px;border-radius:8px;margin-bottom:20px}
input,button{width:100%;padding:10px;margin:10px 0}
</style>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
import { getFirestore, addDoc, collection } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAQkCNtVCzXyIFLNlj9iKQvaMcg197zpKY",
  authDomain: "tttt-57bdb.firebaseapp.com",
  projectId: "tttt-57bdb",
  storageBucket: "tttt-57bdb.firebasestorage.app",
  messagingSenderId: "136572123296",
  appId: "1:136572123296:web:886d093854c6827f10b1c5",
  measurementId: "G-3E8ZVGPDTX"
};


const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

onAuthStateChanged(auth,user=>{
  if(!user || !user.emailVerified){
    location.href="index.html";
  } else {
    email.innerText=user.email;
  }
});

window.addVideo = async()=>{
  await addDoc(collection(db,"videos"),{
    title:title.value,
    url:url.value,
    author:auth.currentUser.email,
    views:0,
    date:new Date()
  });
  alert("Vidéo ajoutée !");
};

window.logout=()=>{
  signOut(auth);
  location.href="index.html";
};
</script>
</head>

<body>

<div class="box">
<h2>Profil</h2>
<p>Email : <span id="email"></span></p>
<button onclick="logout()">Déconnexion</button>
</div>

<div class="box">
<h2>Publier une vidéo</h2>
<input id="title" placeholder="Titre">
<input id="url" placeholder="Lien Google Drive DIRECT">
<button onclick="addVideo()">Publier</button>
</div>

<div class="box">
<h3>Comment publier</h3>
<p>1. Upload sur Google Drive</p>
<p>2. Partage → public</p>
<p>3. Lien :</p>
<code>https://drive.google.com/uc?export=download&id=ID</code>
</div>

</body>
</html>